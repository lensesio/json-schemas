{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Lenses IAM Policy Schema",
  "description": "Schema for defining Lenses IAM policies that control access to resources and operations",
  "markdownDescription": "Schema for defining Lenses IAM policies that control access to resources and operations. [Learn more about IAM policies](https://docs.lenses.io/latest/user-guide/iam)",
  "type": "object",
  "required": ["policy"],
  "properties": {
    "policy": {
      "type": "array",
      "description": "List of policy statements",
      "markdownDescription": "List of policy statements. [View policy documentation](https://docs.lenses.io/latest/user-guide/iam)",
      "items": {
        "$ref": "statement.schema.json"
      }
    }
  },
  "examples": [
    {
      "policy": [
        {
          "sid": "AllowKafkaReadAccess",
          "effect": "allow",
          "action": [
            "kafka:ReadTopicData",
            "kafka:ListTopics",
            "kafka:GetTopicDetails"
          ],
          "resource": ["kafka:topic:*"]
        }
      ]
    }
  ],
  "defaultSnippets": [
    {
      "label": "Allow All",
      "description": "Full access to all resources (use sparingly)",
      "body": {
        "policy": [
          {
            "effect": "allow",
            "action": ["'*'"],
            "resource": ["'*'"]
          }
        ]
      }
    },
    {
      "label": "Allow Specific Actions",
      "description": "Allow specific actions on specific resources",
      "body": {
        "policy": [
          {
            "sid": "${1:StatementId}",
            "effect": "allow",
            "action": ["${2:service:Action}"],
            "resource": ["${3:service:resource-type:*}"]
          }
        ]
      }
    },
    {
      "label": "Deny Specific Actions",
      "description": "Explicitly deny specific actions (overrides allows)",
      "body": {
        "policy": [
          {
            "sid": "${1:DenyStatement}",
            "effect": "deny",
            "action": ["${2:service:Action}"],
            "resource": ["${3:service:resource-type:*}"]
          }
        ]
      }
    },
    {
      "label": "Read-Only Kafka Topics",
      "description": "View and read Kafka topics without modification rights",
      "body": {
        "policy": [
          {
            "effect": "allow",
            "action": [
              "kafka:ListTopics",
              "kafka:GetTopicDetails",
              "kafka:ReadTopicData"
            ],
            "resource": ["kafka:topic:*"]
          }
        ]
      }
    },
    {
      "label": "Environment Access Only",
      "description": "Basic environment access for viewing and proxying",
      "body": {
        "policy": [
          {
            "effect": "allow",
            "action": [
              "environments:ListEnvironments",
              "environments:GetEnvironmentDetails",
              "environments:AccessEnvironment"
            ],
            "resource": ["environments:environment:*"]
          }
        ]
      }
    }
  ]
}
