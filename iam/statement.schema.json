{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Lenses IAM Policy Statement Schema",
  "description": "Schema for a single IAM policy statement that defines access permissions",
  "type": "object",
  "required": ["effect", "action", "resource"],
  "properties": {
    "sid": {
      "type": "string",
      "description": "Statement identifier for documentation and debugging"
    },
    "effect": {
      "type": "string",
      "enum": ["allow", "deny"],
      "description": "Whether the statement allows or denies access"
    },
    "action": {
      "type": "array",
      "description": "List of actions that are allowed or denied",
      "items": {
        "type": "string",
        "enum": [
          "*",
          "administration:CreateConnection",
          "administration:DeleteConnection",
          "administration:GetConnectionDetails",
          "administration:ListConnections",
          "administration:UpdateConnection",
          "administration:GetLensesConfiguration",
          "administration:GetLensesLogs",
          "administration:GetLicenseDetails",
          "administration:ListLicenses",
          "administration:UpdateLicenseDetails",
          "administration:GetSetting",
          "administration:UpdateSetting",
          "alerts:CreateChannel",
          "alerts:DeleteChannel",
          "alerts:GetChannelDetails",
          "alerts:ListChannels",
          "alerts:ToggleChannel",
          "alerts:UpdateChannel",
          "alerts:ListAlertEvents",
          "alerts:CreateAlertRule",
          "alerts:DeleteAlertRule",
          "alerts:GetAlertRuleDetails",
          "alerts:GetChannelRoutes",
          "alerts:ListAlertRules",
          "alerts:ToggleAlertRule",
          "alerts:UpdateAlertRule",
          "alerts:UpdateChannelRoutes",
          "applications:GetApplicationDetails",
          "applications:ListApplicationDependants",
          "applications:ListApplications",
          "applications:RegisterApplication",
          "applications:UnregisterApplication",
          "audit:CreateChannel",
          "audit:DeleteChannel",
          "audit:GetChannelDetails",
          "audit:ListChannels",
          "audit:ToggleChannel",
          "audit:UpdateChannel",
          "audit:DeleteLogs",
          "audit:ListLogs",
          "data-policies:CreatePolicy",
          "data-policies:DeletePolicy",
          "data-policies:GetPolicyDetails",
          "data-policies:ListPolicies",
          "data-policies:UpdatePolicy",
          "environments:AccessEnvironment",
          "environments:CreateEnvironment",
          "environments:DeleteEnvironment",
          "environments:DeleteKafkaConnection",
          "environments:GetEnvironmentDetails",
          "environments:GetKafkaConnectionDetails",
          "environments:ListEnvironments",
          "environments:ListKafkaConnections",
          "environments:UpdateEnvironment",
          "environments:UpsertKafkaConnection",
          "governance:ApproveRequest",
          "governance:CreateRequest",
          "governance:DenyRequest",
          "governance:GetRequestDetails",
          "governance:ListRequests",
          "governance:GetRuleDetails",
          "governance:UpdateRule",
          "iam:CreateGroup",
          "iam:DeleteGroup",
          "iam:GetGroupDetails",
          "iam:ListGroups",
          "iam:UpdateGroup",
          "iam:CreateRole",
          "iam:DeleteRole",
          "iam:GetRoleDetails",
          "iam:ListRoles",
          "iam:UpdateRole",
          "iam:CreateServiceAccount",
          "iam:DeleteServiceAccount",
          "iam:GetServiceAccountDetails",
          "iam:ListServiceAccounts",
          "iam:UpdateServiceAccount",
          "iam:CreateUser",
          "iam:DeleteUser",
          "iam:GetUserDetails",
          "iam:ListUsers",
          "iam:UpdateUser",
          "kafka:CreateAcl",
          "kafka:DeleteAcl",
          "kafka:GetAclDetails",
          "kafka:ListAcls",
          "kafka:UpdateAcl",
          "kafka:DeleteConsumerGroup",
          "kafka:GetConsumerGroupDetails",
          "kafka:ListConsumerGroupDependants",
          "kafka:ListConsumerGroups",
          "kafka:UpdateConsumerGroup",
          "kafka:CreateQuota",
          "kafka:DeleteQuota",
          "kafka:GetQuotaDetails",
          "kafka:ListQuotas",
          "kafka:UpdateQuota",
          "kafka:CreateTopic",
          "kafka:DeleteTopic",
          "kafka:DeleteTopicData",
          "kafka:GetTopicDetails",
          "kafka:ListTopicDependants",
          "kafka:ListTopics",
          "kafka:ReadTopicData",
          "kafka:UpdateTopicDetails",
          "kafka:WriteTopicData",
          "kafka-connect:DeployConnector",
          "kafka-connect:GetClusterDetails",
          "kafka-connect:ListClusters",
          "kafka-connect:CreateConnector",
          "kafka-connect:DeleteConnector",
          "kafka-connect:GetConnectorConfiguration",
          "kafka-connect:GetConnectorDetails",
          "kafka-connect:ListConnectorDependants",
          "kafka-connect:ListConnectors",
          "kafka-connect:StartConnector",
          "kafka-connect:StopConnector",
          "kafka-connect:UpdateConnectorConfiguration",
          "k2k:CreateApp",
          "k2k:DeleteApp",
          "k2k:GetApp",
          "k2k:ListApps",
          "k2k:ManageOffsets",
          "k2k:UpdateApp",
          "k2k:UpsertApp",
          "kubernetes:GetClusterDetails",
          "kubernetes:ListClusters",
          "kubernetes:DeployApps",
          "kubernetes:ListNamespaces",
          "schemas:GetRegistryConfiguration",
          "schemas:UpdateRegistryConfiguration",
          "schemas:CreateSchema",
          "schemas:DeleteSchema",
          "schemas:GetSchemaDetails",
          "schemas:ListSchemas",
          "schemas:UpdateSchema",
          "sql-streaming:CreateProcessor",
          "sql-streaming:DeleteProcessor",
          "sql-streaming:GetProcessorDetails",
          "sql-streaming:GetProcessorLogs",
          "sql-streaming:GetProcessorSql",
          "sql-streaming:ListProcessorDependants",
          "sql-streaming:ListProcessors",
          "sql-streaming:ScaleProcessor",
          "sql-streaming:StartProcessor",
          "sql-streaming:StopProcessor",
          "sql-streaming:UpdateProcessorSql"
        ]
      }
    },
    "resource": {
      "description": "Resource(s) that the policy applies to. Can be a single string or an array of strings.",
      "oneOf": [
        {
          "type": "string",
          "pattern": "^(\\*|(administration:(connection|license|lenses-logs|lenses-configuration|setting)|applications:(external-application)|alerts:(rule|event|channel)|audit:(log|channel)|data-policies:(policy)|environments:(environment|kafka-connection)|governance:(request|rule)|iam:(user|group|role|service-account)|k2k:(app)|kafka-connect:(connector|cluster)|kafka:(topic|acl|quota|consumer-group|cluster)|kubernetes:(cluster|namespace)|schemas:(registry|schema)|sql-streaming:(sql-processor)):(\\*|[a-zA-Z0-9-/*]+))$",
          "description": "Lenses Resource Name (LRN) in the format service:resource-type:resource-id. Wildcards (*) are allowed."
        },
        {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^(\\*|(administration:(connection|license|lenses-logs|lenses-configuration|setting)|applications:(external-application)|alerts:(rule|event|channel)|audit:(log|channel)|data-policies:(policy)|environments:(environment|kafka-connection)|governance:(request|rule)|iam:(user|group|role|service-account)|k2k:(app)|kafka-connect:(connector|cluster)|kafka:(topic|acl|quota|consumer-group|cluster)|kubernetes:(cluster|namespace)|schemas:(registry|schema)|sql-streaming:(sql-processor)):(\\*|[a-zA-Z0-9-/*]+))$",
            "description": "Lenses Resource Name (LRN) in the format service:resource-type:resource-id. Wildcards (*) are allowed."
          }
        }
      ]
    }
  },
  "additionalProperties": false
}
